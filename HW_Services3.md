**Вы работаете в крупной компанию, которая строит систему на основе микросервисной архитектуры.** <br> 
**Вам как DevOps специалисту необходимо выдвинуть предложение по организации инфраструктуры, для разработки и эксплуатации.** <br>

**Задача 1: Обеспечить разработку** <br>
**Предложите решение для обеспечения процесса разработки: хранение исходного кода, непрерывная интеграция и непрерывная поставка.** <br> 
**Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.** <br>

**Решение должно соответствовать следующим требованиям:** <br>

**Облачная система;** <br>
**Система контроля версий Git;** <br>
**Репозиторий на каждый сервис;** <br>
**Запуск сборки по событию из системы контроля версий;** <br>
**Запуск сборки по кнопке с указанием параметров;** <br>
**Возможность привязать настройки к каждой сборке;** <br>
**Возможность создания шаблонов для различных конфигураций сборок;** <br>
**Возможность безопасного хранения секретных данных: пароли, ключи доступа;** <br>
**Несколько конфигураций для сборки из одного репозитория;** <br>
**Кастомные шаги при сборке;** <br>
**Возможность развернуть агентов сборки на собственных серверах;** <br>
**Возможность параллельного запуска нескольких сборок;** <br>
**Возможность параллельного запуска тестов;** <br>
**Обоснуйте свой выбор** <br>.

_**Решение**_ <br>

_Рекомендую использовать сочетание Bitbucket, TeamCity, Nexus_ <br>

_Bitbucket удовлетворяет следующие требования:_ <br>
_Облачная система;_ <br>
_Система контроля версий Git;_ <br>
_Репозиторий на каждый сервис;_ <br>

_Bitbucket - если команда большая удобнее работать с Jira. _ <br>
_Также можно настроить права на развертывание кода на сервере, чтобы избежать случайных и нежелательных изменений в коде. _ <br>
_Еще в Bitbucket есть система устранения инцидентов и откатывать изменения, приведшее к инциденту._ <br>

_Teamcity соответсвуте всем остальным требованиям:_ <br>

_Запуск сборки по событию из системы контроля версий;_ <br>
_Запуск сборки по кнопке с указанием параметров;_ <br>
_Возможность привязать настройки к каждой сборке;_ <br>
_Возможность создания шаблонов для различных конфигураций сборок;_ <br>
_Возможность безопасного хранения секретных данных: пароли, ключи доступа;_ <br>
_Несколько конфигураций для сборки из одного репозитория;_ <br>
_Кастомные шаги при сборке;_ <br>
_Возможность развернуть агентов сборки на собственных серверах;_ <br>
_Возможность параллельного запуска нескольких сборок;_ <br>
_Возможность параллельного запуска тестов;_ <br>

**Задача 2: Логи** <br>
**Предложите решение для обеспечения сбора и анализа логов сервисов в микросервисной архитектуре.** <br>
**Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.** <br>

**Решение должно соответствовать следующим требованиям:** <br>

**Сбор логов в центральное хранилище со всех хостов обслуживающих систему;** <br>
**Минимальные требования к приложениям, сбор логов из stdout;** <br>
**Гарантированная доставка логов до центрального хранилища;** <br>
**Обеспечение поиска и фильтрации по записям логов;** <br>
**Обеспечение пользовательского интерфейса с возможностью предоставления доступа разработчикам для поиска по записям логов;** <br>
**Возможность дать ссылку на сохраненный поиск по записям логов;** <br>
**Обоснуйте свой выбор.** <br>

_Решение_ <br>

_Как инструменты логирования рекомендую использовать стек ELK , который позволяет собирать,_ <br>
_хранить и обрабатывать логи со всех хостов, устанавливать алерты и обрабатывать статистические данные (например, повторяемость)._ <br>
_Соответствует всем предъявленным требованиям к логам._ <br>

_Масштабируемость – кластер Elasticsearch (ES) расширяется «на лету» добавлением новых серверов._ <br> 
_При этом распределение нагрузки по узлам происходит автоматически._ <br>

_Отказоустойчивость — в случае сбоя кластерных узлов данные не потеряются, а будут перераспределены,_ <br> 
_и поисковая система сама продолжит работу. _ <br>
_Операционная стабильность достигается ведением логов на каждое изменение данных в хранилище сразу на нескольких узлах кластера._ <br>

_Гибкость поисковых фильтров, включая нечеткий поиск, вБлагодаря наличию встроенных анализаторов текста Elasticsearch автоматически выполняет токенизацию,_ <br>
_лемматизацию, стемминг и прочие преобразования текста для решения NLP-задач, связанных с поиском данных._ <br>
 
_Управляемость ES по HTTP с помощью JSON-запросов за счет REST API и визуального веб-интерфейса Kibana._ м

_Универсальность – Logsatsh в потоковом режиме работает одновременно со множеством разных источников данных (СУБД, файлы, системные логи, веб-приложения и пр.),_ <br> 
_фильтруя и преобразуя их для отправки в хранилище ES._ <br> 

**Задача 3: Мониторинг** <br>
**Предложите решение для обеспечения сбора и анализа состояния хостов и сервисов в микросервисной архитектуре.** <br>
**Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.** <br>

**Решение должно соответствовать следующим требованиям:** <br>

**Сбор метрик со всех хостов, обслуживающих систему;** <br>
**Сбор метрик состояния ресурсов хостов: CPU, RAM, HDD, Network;** <br>
**Сбор метрик потребляемых ресурсов для каждого сервиса: CPU, RAM, HDD, Network;** <br>
**Сбор метрик, специфичных для каждого сервиса;** <br>
**Пользовательский интерфейс с возможностью делать запросы и агрегировать информацию;** <br>
**Пользовательский интерфейс с возможность настраивать различные панели для отслеживания состояния системы;** <br>
**Обоснуйте свой выбор.** <br>

_Решение_ <br>

_Все предъявленные требования к мониторингу покрывают Prometeus/Victoria Metrics, Cadvisor, Grafana._ <br>
_Prometeus является специализированной системой сбора метрик и легко расширяется для сбора custom метрик при помощи написания собственных экспортеров._ <br>
_В случае использования Kubernetes лучше подойдет Victoria Metrics - это СУБД временных рядов, совместимая с API Kubernetes._ <br>
_Она работает по принципу подписки, реагируя на изменения подов (под — это набор контейнеров, объединенных общим пространством имен)._ <br>
_Cadvisor - инструмент сбора метрик контейнеров (в случае использования docker)_ <br>
_Grafana является системой пользовательского интерфейса для просмотра метрик, и обладает широкими возможностями._ <br>
